<!doctype html>
<html lang="en">
 <head>
  <title>Integrated application</title>
 </head>
 <body>
  <div id="identifier"></div>
  
  <input id="message" type="text" />
  
  <button onclick="sendMessage(dynamics)">Send message!</button>
  
  <script type="text/javascript">
   const logPrefix = "[Dynamics integration]: ";
   const link = "https://svalyavakilia.github.io:443/iframe-test/dynamics.html";
   
   function log(text) {
    console.log(logPrefix + text);
   }
   
   let dynamics = null;
   
   window.addEventListener("load", (event) => {
    log("application is loaded.");
    
    log("before opening a new tab.");
    dynamics = window.open(link, "_blank");
    log("after opening a new tab.");
   });
   
   function sendMessage(window) {
    const message = document.getElementById("message").value;
    
    log("posting message '" + message + ".");
    window.postMessage({ "data": message }, "*");
    log("message was posted.");
   }
   
   const parameters = new URLSearchParams(document.location.search);
   
   const identifier = parameters.get("identifier");
   
   document.getElementById("identifier").innerText =
    "Identyfikator bieżącej interakcji: " + identifier;
  </script>
 </body>
</html>